# Verification of computational claims in the proof of the lemma on Atkin multi-roots
R.<Y,j> = ZZ[]
LPrime = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 41, 47, 59, 71]

# These are the Atkin modular polynomials Phi_ell^A(Y,j)
AtkinModPoly = {
    2: j^2 + (-Y^2 - Y + 7256)*j + Y^3 + 744*Y^2 + 184512*Y + 15252992,
    3: j^2 + (-Y^3 + 2348*Y + 24528)*j + Y^4 + 744*Y^3 + 193752*Y^2 + 19712160*Y + 538141968,
    5: j^2 + (-Y^5 + 670*Y^3 + 3800*Y^2 - 73056*Y - 449408)*j + Y^6 + 744*Y^5 + 196080*Y^4 + 20990720*Y^3 + 756084480*Y^2 + 11062339584*Y + 57333846016,
    7: j^2 + (-Y^7 + 357*Y^5 + 1428*Y^4 - 31647*Y^3 - 204792*Y^2 + 186955*Y + 2128500)*j + Y^8 + 744*Y^7 + 196476*Y^6 + 21226520*Y^5 + 803037606*Y^4 + 14547824088*Y^3 + 138917735740*Y^2 + 677600447400*Y + 1335206318625,
    11: j^2 + (-Y^11 + 187*Y^9 + 506*Y^8 - 11440*Y^7 - 57442*Y^6 + 184184*Y^5 + 1675784*Y^4 + 1867712*Y^3 - 8252640*Y^2 - 19849600*Y - 8720000)*j + Y^12 + 744*Y^11 + 196680*Y^10 + 21354080*Y^9 + 830467440*Y^8 + 16875327744*Y^7 + 208564958976*Y^6 + 1678582287360*Y^5 + 9031525113600*Y^4 + 32349979904000*Y^3 + 74246810880000*Y^2 + 98997734400000*Y + 58411072000000,
    13: j^2 + (-Y^13 + 156*Y^11 + 364*Y^10 - 8502*Y^9 - 37596*Y^8 + 149786*Y^7 + 1161420*Y^6 + 700323*Y^5 - 9614956*Y^4 - 23669490*Y^3 - 5859360*Y^2 + 32384000*Y + 24576000)*j + Y^14 + 744*Y^13 + 196716*Y^12 + 21377304*Y^11 + 835688022*Y^10 + 17348897592*Y^9 + 224269358092*Y^8 + 1949972557416*Y^7 + 11858099339697*Y^6 + 51262531538400*Y^5 + 157275877324800*Y^4 + 335383326720000*Y^3 + 473336381440000*Y^2 + 397934592000000*Y + 150994944000000,
    17: j^2 + (-Y^17 + 119*Y^15 + 238*Y^14 - 5338*Y^13 - 20808*Y^12 + 91766*Y^11 + 630836*Y^10 + 70737*Y^9 - 7118240*Y^8 - 16023299*Y^7 + 13049914*Y^6 + 98725154*Y^5 + 125706976*Y^4 - 18738794*Y^3 - 169635044*Y^2 - 128884056*Y - 25608112)*j + Y^18 + 744*Y^17 + 196758*Y^16 + 21404972*Y^15 + 842077983*Y^14 + 17948904708*Y^13 + 244914883280*Y^12 + 2329163268408*Y^11 + 16210658303007*Y^10 + 85028433903248*Y^9 + 341892490692606*Y^8 + 1062287798439420*Y^7 + 2550866026451633*Y^6 + 4696728278154564*Y^5 + 6513943516038012*Y^4 + 6589528427769248*Y^3 + 4591535167608048*Y^2 + 1971050433995328*Y + 393059647379008,
    19: j^2 + (-Y^19 + 114*Y^17 + 190*Y^16 - 5073*Y^15 - 16416*Y^14 + 97983*Y^13 + 519042*Y^12 - 444030*Y^11 - 6935646*Y^10 - 9356265*Y^9 + 30202704*Y^8 + 101838024*Y^7 + 54954270*Y^6 - 190349904*Y^5 - 358921248*Y^4 - 196605312*Y^3 + 51363840*Y^2 + 90675200*Y + 24576000)*j + Y^20 + 744*Y^19 + 196764*Y^18 + 21408744*Y^17 + 842900838*Y^16 + 18021846408*Y^15 + 247470430652*Y^14 + 2378790004632*Y^13 + 16832768334177*Y^12 + 90478701945424*Y^11 + 376813671380832*Y^10 + 1230336247503168*Y^9 + 3167090980261888*Y^8 + 6427791537328128*Y^7 + 10228514018144256*Y^6 + 12607776060866560*Y^5 + 11787418347110400*Y^4 + 8074192060416000*Y^3 + 3819278172160000*Y^2 + 1114216857600000*Y + 150994944000000,
    23: j^2 + (-Y^23 + 92*Y^21 + 161*Y^20 - 3381*Y^19 - 11799*Y^18 + 52992*Y^17 + 329912*Y^16 - 64354*Y^15 - 4070172*Y^14 - 8030680*Y^13 + 15573852*Y^12 + 83684166*Y^11 + 82673546*Y^10 - 197662552*Y^9 - 630176770*Y^8 - 539366445*Y^7 + 414060444*Y^6 + 1353267468*Y^5 + 1221122187*Y^4 + 352943487*Y^3 - 181569843*Y^2 - 160117560*Y - 33162750)*j + Y^24 + 744*Y^23 + 196788*Y^22 + 21425144*Y^21 + 846858114*Y^20 + 18412588728*Y^19 + 261509846820*Y^18 + 2653526500200*Y^17 + 20297265562863*Y^16 + 121196114417552*Y^15 + 578463396147048*Y^14 + 2243394859042608*Y^13 + 7148355378741532*Y^12 + 18847144878940656*Y^11 + 41268530291716584*Y^10 + 75088732151084112*Y^9 + 113242634769312495*Y^8 + 140711367288816648*Y^7 + 142601765879687652*Y^6 + 116031943069958232*Y^5 + 74019442027746690*Y^4 + 35677474681909464*Y^3 + 12224202022163700*Y^2 + 2654969306445000*Y + 274941996890625,
    29: j^2 + (-Y^29 + 87*Y^27 + 116*Y^26 - 3190*Y^25 - 8410*Y^24 + 58609*Y^23 + 250096*Y^22 - 446948*Y^21 - 3798478*Y^20 - 1839325*Y^19 + 29048836*Y^18 + 60669740*Y^17 - 74266274*Y^16 - 417624447*Y^15 - 335295216*Y^14 + 926385338*Y^13 + 2264528742*Y^12 + 991421869*Y^11 - 2827599296*Y^10 - 4839426736*Y^9 - 2342897182*Y^8 + 1524764523*Y^7 + 2730136212*Y^6 + 1542267009*Y^5 + 331728390*Y^4 - 47986938*Y^3 - 41239044*Y^2 - 8232840*Y - 574992)*j + Y^30 + 744*Y^29 + 196794*Y^28 + 21428912*Y^27 + 847678845*Y^26 + 18485193108*Y^25 + 264053702726*Y^24 + 2703799024596*Y^23 + 20954419230498*Y^22 + 127383142791380*Y^21 + 622630299713550*Y^20 + 2490582040617096*Y^19 + 8257833102576581*Y^18 + 22903838009218308*Y^17 + 53481631524449250*Y^16 + 105573321997071788*Y^15 + 176571448472005938*Y^14 + 250331840505695868*Y^13 + 300498029919050194*Y^12 + 304569122022135720*Y^11 + 259470415036246653*Y^10 + 184610357611849980*Y^9 + 108750768276390570*Y^8 + 52441355322129780*Y^7 + 20393914222601145*Y^6 + 6270408550842084*Y^5 + 1483268194671516*Y^4 + 259454754494496*Y^3 + 31512159988848*Y^2 + 2366908568640*Y + 82653950016,
    31: j^2 + (-Y^31 + 93*Y^29 + 93*Y^28 - 3720*Y^27 - 7254*Y^26 + 80197*Y^25 + 237708*Y^24 - 940509*Y^23 - 4184969*Y^22 + 4557930*Y^21 + 41821542*Y^20 + 19054584*Y^19 - 225388104*Y^18 - 365294142*Y^17 + 482826674*Y^16 + 1774934109*Y^15 + 697534038*Y^14 - 3105288879*Y^13 - 4499034681*Y^12 - 343835136*Y^11 + 4393744638*Y^10 + 4271395977*Y^9 + 1024559610*Y^8 - 1009134351*Y^7 - 972695277*Y^6 - 363257256*Y^5 - 56466562*Y^4 + 2276640*Y^3 + 1821312*Y^2 + 157696*Y)*j + Y^32 + 744*Y^31 + 196788*Y^30 + 21424472*Y^29 + 846515202*Y^28 + 18360955032*Y^27 + 259418996196*Y^26 + 2609965193352*Y^25 + 19725046497903*Y^24 + 115970566264368*Y^23 + 543379611854760*Y^22 + 2064121598802672*Y^21 + 6435971663151644*Y^20 + 16618982897267376*Y^19 + 35762803407338856*Y^18 + 64405629874670736*Y^17 + 97313472737569263*Y^16 + 123490445693624136*Y^15 + 131573820214014564*Y^14 + 117504369028734264*Y^13 + 87683167574480898*Y^12 + 54404978620326968*Y^11 + 27873666552454836*Y^10 + 11678905176336744*Y^9 + 3949629410510209*Y^8 + 1058805016870944*Y^7 + 219342454047552*Y^6 + 33811490402304*Y^5 + 3648637710336*Y^4 + 246000254976*Y^3 + 7809531904*Y^2,
    41: j^2 + (-Y^41 + 82*Y^39 + 82*Y^38 - 2993*Y^37 - 5904*Y^36 + 61295*Y^35 + 186878*Y^34 - 719550*Y^33 - 3368396*Y^32 + 3823947*Y^31 + 37330172*Y^30 + 14567546*Y^29 - 252993944*Y^28 - 398937052*Y^27 + 921665404*Y^26 + 2997624718*Y^25 - 477306256*Y^24 - 11540301242*Y^23 - 10778220876*Y^22 + 20979990034*Y^21 + 46443045528*Y^20 - 22251602*Y^19 - 81968693876*Y^18 - 67155860005*Y^17 + 52624546648*Y^16 + 106954336596*Y^15 + 19939191914*Y^14 - 65788146909*Y^13 - 41997759272*Y^12 + 14993409515*Y^11 + 20770132190*Y^10 + 503883932*Y^9 - 4984619772*Y^8 - 765467417*Y^7 + 656792448*Y^6 + 113725964*Y^5 - 46463824*Y^4 - 5016186*Y^3 + 1272312*Y^2 + 23328*Y - 3456)*j + Y^42 + 744*Y^41 + 196800*Y^40 + 21432668*Y^39 + 848491392*Y^38 + 18555825264*Y^37 + 266402806138*Y^36 + 2747039591568*Y^35 + 21471502358352*Y^34 + 131744120703388*Y^33 + 649763584700160*Y^32 + 2617821380985168*Y^31 + 8707020615606487*Y^30 + 24050634395757720*Y^29 + 55257397001384880*Y^28 + 105243388188532088*Y^27 + 164485652951265792*Y^26 + 206425662829818720*Y^25 + 198470580808903244*Y^24 + 128770280806158816*Y^23 + 26414091729925152*Y^22 - 52810097083191976*Y^21 - 70893548219567616*Y^20 - 38741953156919904*Y^19 + 613458646237759*Y^18 + 16144321556109720*Y^17 + 10008576086301984*Y^16 + 456121028028076*Y^15 - 2510153924472960*Y^14 - 1113859613991120*Y^13 + 130956287900122*Y^12 + 220905086751888*Y^11 + 26773577585040*Y^10 - 19937875912564*Y^9 - 3380214349056*Y^8 + 1150271539728*Y^7 - 59186333879*Y^6 - 48657423384*Y^5 + 25753194864*Y^4 - 4037485824*Y^3 + 624879360*Y^2 - 40310784*Y + 2985984,
    47: j^2 + (-Y^47 + 47*Y^45 + 94*Y^44 - 893*Y^43 - 3901*Y^42 + 4512*Y^41 + 63826*Y^40 + 106126*Y^39 - 397949*Y^38 - 1970287*Y^37 - 1548791*Y^36 + 11032592*Y^35 + 37290881*Y^34 + 20506852*Y^33 - 164048236*Y^32 - 489673589*Y^31 - 338543350*Y^30 + 1392949481*Y^29 + 4473733164*Y^28 + 4587443131*Y^27 - 5508879071*Y^26 - 26077778168*Y^25 - 37789184588*Y^24 - 6830511504*Y^23 + 78580643495*Y^22 + 166015474063*Y^21 + 150764620407*Y^20 - 32176935550*Y^19 - 307573698421*Y^18 - 473869448524*Y^17 - 361798361090*Y^16 - 1448157608*Y^15 + 379916048460*Y^14 + 543680621224*Y^13 + 429524564158*Y^12 + 171503739216*Y^11 - 46474295600*Y^10 - 133639747360*Y^9 - 115299405856*Y^8 - 62085661440*Y^7 - 21754463616*Y^6 - 3947530752*Y^5 + 438349824*Y^4 + 527579136*Y^3 + 163731456*Y^2 + 25878528*Y + 1769472)*j + Y^48 + 744*Y^47 + 196836*Y^46 + 21458696*Y^45 + 855174306*Y^44 + 19261192200*Y^43 + 293409449092*Y^42 + 3323533193400*Y^41 + 29662425295023*Y^40 + 216809396940544*Y^39 + 1333841011819896*Y^38 + 7048100964206640*Y^37 + 32485143466947964*Y^36 + 132183665367205776*Y^35 + 479419882707450216*Y^34 + 1561917823626777584*Y^33 + 4599803199621322095*Y^32 + 12308364951599907816*Y^31 + 30052652025666665780*Y^30 + 67188895018382409576*Y^29 + 137935808127990829410*Y^28 + 260624228494622489960*Y^27 + 454040573413747453140*Y^26 + 730320103004718951384*Y^25 + 1085666189304331263937*Y^24 + 1492486392910776697776*Y^23 + 1897887097040901982320*Y^22 + 2232253635182721260512*Y^21 + 2427448539484645131936*Y^20 + 2438709916770326280576*Y^19 + 2260934803222813700416*Y^18 + 1931441796006473760000*Y^17 + 1517427522506006003712*Y^16 + 1093788136718972063744*Y^15 + 721266588884127510528*Y^14 + 433581450239438684160*Y^13 + 236603667285134848000*Y^12 + 116610071529603760128*Y^11 + 51586780799369281536*Y^10 + 20331301172032438272*Y^9 + 7072749799388872704*Y^8 + 2146604542987862016*Y^7 + 559971570319884288*Y^6 + 123095480729075712*Y^5 + 22189120444956672*Y^4 + 3151835393163264*Y^3 + 331106545041408*Y^2 + 22895665348608*Y + 782757789696,
    59: j^2 + (-Y^59 + 59*Y^57 + 59*Y^56 - 1534*Y^55 - 3127*Y^54 + 21417*Y^53 + 72098*Y^52 - 143193*Y^51 - 916447*Y^50 - 174286*Y^49 + 6516727*Y^48 + 11515738*Y^47 - 19221846*Y^46 - 92182957*Y^45 - 65239368*Y^44 + 284253976*Y^43 + 754619145*Y^42 + 308671598*Y^41 - 1977259920*Y^40 - 4550403910*Y^39 - 2575381270*Y^38 + 7632475764*Y^37 + 20657216762*Y^36 + 19963085715*Y^35 - 9507261180*Y^34 - 59805257547*Y^33 - 91253130157*Y^32 - 55180018686*Y^31 + 60666698493*Y^30 + 201693103797*Y^29 + 266853603370*Y^28 + 176572038603*Y^27 - 59881108419*Y^26 - 333403380486*Y^25 - 495749968855*Y^24 - 451258867420*Y^23 - 214958799438*Y^22 + 100904630525*Y^21 + 356956184970*Y^20 + 462413784548*Y^19 + 410304447353*Y^18 + 260679395796*Y^17 + 94424809972*Y^16 - 28887189420*Y^15 - 88472297848*Y^14 - 95279288800*Y^13 - 73656872866*Y^12 - 45446452976*Y^11 - 22881418704*Y^10 - 9210419200*Y^9 - 2701208800*Y^8 - 347512832*Y^7 + 190061184*Y^6 + 170524160*Y^5 + 78057472*Y^4 + 24891392*Y^3 + 5679104*Y^2 + 860160*Y + 65536)*j + Y^60 + 744*Y^59 + 196824*Y^58 + 21449804*Y^57 + 852838392*Y^56 + 19010437200*Y^55 + 283870193154*Y^54 + 3121306807272*Y^53 + 26794809624648*Y^52 + 186864835761788*Y^51 + 1089596659921176*Y^50 + 5429171365998528*Y^49 + 23515381486966415*Y^48 + 89761876900961664*Y^47 + 305390814541943808*Y^46 + 934834414369804760*Y^45 + 2595278590238550288*Y^44 + 6578887648395775200*Y^43 + 15317063604831148764*Y^42 + 32918980935352336848*Y^41 + 65595071892159407568*Y^40 + 121650046629994844120*Y^39 + 210679605442135698672*Y^38 + 341722255866096843456*Y^37 + 520447784466381114799*Y^36 + 745944561271229478120*Y^35 + 1008112215269437337880*Y^34 + 1286824456157993527836*Y^33 + 1553714110506741455448*Y^32 + 1776659327138169886032*Y^31 + 1926068791350543716610*Y^30 + 1981281794025566395080*Y^29 + 1935186419547598382568*Y^28 + 1795654453126867461804*Y^27 + 1583416917959549905656*Y^26 + 1327144206357049404672*Y^25 + 1057297731952629159073*Y^24 + 800507916585895897392*Y^23 + 575810959708683451920*Y^22 + 393293620498880729792*Y^21 + 254898593554188837792*Y^20 + 156613418511509270016*Y^19 + 91116190286820343104*Y^18 + 50123929037547413760*Y^17 + 26026933571054505984*Y^16 + 12729782448375726080*Y^15 + 5849918901088628736*Y^14 + 2518278785550630912*Y^13 + 1011843399066497024*Y^12 + 377817059463168000*Y^11 + 130406029062242304*Y^10 + 41334680308416512*Y^9 + 11933646090534912*Y^8 + 3105556893007872*Y^7 + 718615179165696*Y^6 + 145168964517888*Y^5 + 24950303883264*Y^4 + 3511018323968*Y^3 + 380104605696*Y^2 + 28185722880*Y + 1073741824,
    71: j^2 + (-Y^71 + 71*Y^69 + 71*Y^68 - 2343*Y^67 - 4686*Y^66 + 45440*Y^65 + 143207*Y^64 - 532571*Y^63 - 2646312*Y^62 + 3017855*Y^61 + 32313875*Y^60 + 12535334*Y^59 - 264727618*Y^58 - 436340724*Y^57 + 1349702048*Y^56 + 4562424855*Y^55 - 2470074167*Y^54 - 28370520232*Y^53 - 21838230836*Y^52 + 108115393917*Y^51 + 223748200881*Y^50 - 178499735948*Y^49 - 1049626967323*Y^48 - 559609774297*Y^47 + 2804372906166*Y^46 + 4756674670971*Y^45 - 2852043212765*Y^44 - 15532407929486*Y^43 - 8910386482360*Y^42 + 26684853528524*Y^41 + 45189635779980*Y^40 - 10070390189979*Y^39 - 93526428598685*Y^38 - 67340538668100*Y^37 + 92238664550530*Y^36 + 181011248436643*Y^35 + 20416496340435*Y^34 - 222113110063628*Y^33 - 198858847792011*Y^32 + 104404339449123*Y^31 + 289422447801750*Y^30 + 100351154110315*Y^29 - 201255962070609*Y^28 - 219621557336740*Y^27 + 23874469114128*Y^26 + 180309303758044*Y^25 + 88838046950616*Y^24 - 67961958775580*Y^23 - 90628940915831*Y^22 - 8381691827967*Y^21 + 43318072084785*Y^20 + 24438297785886*Y^19 - 8464593397081*Y^18 - 13701811602284*Y^17 - 2311159191326*Y^16 + 3893638186944*Y^15 + 2135340401604*Y^14 - 406581485800*Y^13 - 687410216130*Y^12 - 106005364016*Y^11 + 115455743472*Y^10 + 48344218080*Y^9 - 7719267680*Y^8 - 8267735296*Y^7 - 582840704*Y^6 + 698430976*Y^5 + 135084032*Y^4 - 24864768*Y^3 - 7124992*Y^2 + 172032*Y + 65536)*j + Y^72 + 744*Y^71 + 196812*Y^70 + 21440864*Y^69 + 850467678*Y^68 + 18750752952*Y^67 + 273398523104*Y^66 + 2885098620072*Y^65 + 23246750551989*Y^64 + 147955918691960*Y^63 + 760084617742584*Y^62 + 3191560906282152*Y^61 + 11001014803134138*Y^60 + 30957035570562480*Y^59 + 69589906111841148*Y^58 + 117659977505076440*Y^57 + 120707092080875130*Y^56 - 36922893656233032*Y^55 - 464145729581960988*Y^54 - 1056367260657963792*Y^53 - 1268752992701741610*Y^52 - 258141786519024952*Y^51 + 2254714423751242728*Y^50 + 4833512690145986184*Y^49 + 4417105761111188301*Y^48 - 1063950812979568248*Y^47 - 9023715784301531496*Y^46 - 12058661672414263720*Y^45 - 4242760640706779274*Y^44 + 10669343486749416048*Y^43 + 19317555208270699492*Y^42 + 11010531983564034312*Y^41 - 8988119622792490758*Y^40 - 21878580482038285144*Y^39 - 14361453916457816772*Y^38 + 6123112477245485808*Y^37 + 18845945476709696026*Y^36 + 12399140016864100344*Y^35 - 3957340783229923320*Y^34 - 12681515651967942824*Y^33 - 7548249545717785035*Y^32 + 2551683158596341480*Y^31 + 6646726490659339216*Y^30 + 3267890650832979624*Y^29 - 1438099714787060514*Y^28 - 2660882371120891808*Y^27 - 993595607669832036*Y^26 + 615516009969950760*Y^25 + 797855036408317761*Y^24 + 210007062502179888*Y^23 - 188288296326578736*Y^22 - 179024004501894560*Y^21 - 31419433663409184*Y^20 + 41368243920326784*Y^19 + 30775361039747904*Y^18 + 3418846599013632*Y^17 - 6773620879405056*Y^16 - 4118317317189632*Y^15 - 256307528282112*Y^14 + 833950736449536*Y^13 + 425170906558464*Y^12 + 13392684023808*Y^11 - 76365540950016*Y^10 - 33722381238272*Y^9 - 398813429760*Y^8 + 5100233293824*Y^7 + 1904719167488*Y^6 + 9157214208*Y^5 - 221559914496*Y^4 - 72662122496*Y^3 + 5637144576*Y + 1073741824,
}

for l in LPrime:
    Atkin = AtkinModPoly[l]

    # Compute the necessary derivatives first
    Delta = Atkin.derivative(j)
    theta1 = Atkin.derivative(Y)
    theta2 = theta1.derivative(Y)

    # For claim (a), compute the first two j-resultants
    res_Delta = Atkin.resultant(Atkin-Delta, variable=j)
    res_01 = Atkin.resultant(Atkin-theta1, variable=j)

    # Factor the resultants as in the proof
    h = gcd(res_Delta, res_01)
    g_Delta = res_Delta//(-h)
    g_theta = res_01//(-h*l)

    # Check that the factors are all monic
    assert h.coefficients()[0] == 1
    assert g_Delta.coefficients()[0] == 1
    assert g_theta.coefficients()[0] == 1

    # Compute the integer n_l, and confirm the shape of the third computed resultant simultaneously
    n = g_theta.resultant(g_theta - theta1, variable=Y)
    while n(j=0) == 0:
        n = n // j
    while n(j=1728) == 0:
        n = n//(j-1728)
    assert n in NN

    # Now iterate over all prime factors of n, ...
    for (p,e) in n.factor():

        # ... (except ell), ...
        if p == l: continue

        # ... reduce g_theta, Phi_ell^A and theta_ell^(1) modulo p ...
        Rp.<Yp,jp> = GF(p)[]
        Atkinp = Atkin(Y=Yp, j=jp)
        theta1p = theta1(Y=Yp, j=jp)
        gp_theta = g_theta(Y=Yp, j=jp)

        # ... and check for all roots ...
        for (s, m) in gp_theta.factor():
            R_split.<Xp> = GF(p^s.degree(), "i")[]
            for (t, b) in s(Yp=Xp).factor():
                assert t.degree() == 1  # Sanity check: Taking the degree deg(s) extension of Fp splits s
                root = -t(Xp=0)
    
                # ... the necessary divisibility claim
                assert Atkinp(Yp=root).gcd(theta1p(Yp=root), variable=j).divides(jp^2*(jp-1728)^2)

    print(f"The computations claims for part (a) of the lemma are correct for l = {l}!")

    # For claim (b), compute the other four j-resultants
    res_02 = Atkin.resultant(Atkin - theta2, variable=j)
    res_12 = (Atkin-theta1).resultant(Atkin-theta2, variable=j)
    res_1D = (Atkin-theta1).resultant(Atkin-Delta, variable=j)
    res_2D = (Atkin-theta2).resultant(Atkin-Delta, variable=j)

    # Put all resultants together in one list for easier code
    res_list = [res_01, res_02, res_Delta, res_12, res_1D, res_2D]

    # Divide out common factors ...
    for i in range(len(res_list)):
        r = res_list[i]

        # ... with Phi_ell^A(Y,0) ...
        g = r.gcd(Atkin(j=0), variable=Y)
        while g != 1:
            r = r//g
            g = r.gcd(Atkin(j=0), variable=Y)

        #  ... and Phi_ell^A(Y, 1728) ...
        g = r.gcd(Atkin(j=1728), variable=Y)
        while g != 1:
            r = r//g
            g = r.gcd(Atkin(j=1728), variable=Y)
        
        # ... to obtain the polynomial r_i
        res_list[i] = r

    # Compute the integer a_l stepwise
    a = 0
    for i in range(6):
        for k in range(i+1, 6):
            a = a.gcd(ZZ(res_list[i].resultant(res_list[k], variable=Y)))

    # Verify that the leading coefficient of each r_i divides a_l
    for i in range(6):
        assert r.coefficients()[0].divides(a)

    # Now iterate over all prime factors of a ...
    for (q,e) in a.factor():

        # ... (except ell), ...
        if q == l: continue

        # ... reduce the polynomials r_i modulo q and take their gcd ...
        Rq.<Yq,jq> = GF(q)[]
        resq = gcd([t(Y=Yq,j=jq) for t in res_list], variable=Yq)

        # ... and check for all its roots ...
        for (s,m) in resq.factor():
            R_split.<Xq> = GF(q^s.degree(), "i")[]
            for (t,b) in s(Yq=Xq).factor():
                assert t.degree() == 1  # Sanity check: Taking the degree deg(s) extension of Fp splits s
                root = -t(Xq=0)

                # ... that they are not triple roots of any Phi_ell^A(Y,j0) with j0 != 0, 1728
                for (u,e) in Atkin(Y=root, j=jq).factor():
                    assert u.degree() == 1
                    j0 = -u(jq=0)
                    if j0 != 0 and j0 != 1728:
                        # This case will only occur for q = 2, where we fail to compute root multiplicities with derivatives
                        assert q == 2    
                        assert not ((Yq-root)^3).divides(Atkin(Y=Yq, j=j0))
                        

    print(f"The computations claims for part (b) of the lemma are correct for l = {l}!")

    # Separation line
    print("---------------------------------------")